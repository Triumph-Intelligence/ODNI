<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Triumph Intelligence - Multi-organization customer relationship management system">
    <meta name="author" content="Triumph Atlantic">
    <title>Triumph Intelligence</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè¢</text></svg>">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/themes.css">
    
    <style>
        /* Layout fixes for proper screen fitting */
        .app-container {
            display: flex;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding-top: var(--header-height);
            overflow-y: auto;
            overflow-x: hidden;
            background: transparent;
            width: calc(100vw - var(--sidebar-width));
            max-width: 100%;
        }
        
        .page {
            max-width: 1600px;
            margin: 0 auto;
            padding: var(--spacing-xl);
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }
        
        .table-container,
        .card {
            max-width: 100%;
            overflow: hidden;
        }
        
        .table-wrapper {
            overflow-x: auto;
            max-height: 600px;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1400px) {
            .page {
                padding: var(--spacing-lg);
            }
        }
        
        @media (max-width: 1200px) {
            .card-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .main-content {
                margin-left: 0;
                width: 100vw;
            }
            
            .page {
                padding: var(--spacing-md);
            }
            
            .card-grid {
                grid-template-columns: 1fr;
            }
            
            .page-actions {
                flex-direction: column;
                width: 100%;
            }
            
            .page-actions .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1 class="header-brand">CRM Portal</h1>
            
            <div class="header-controls">
                <!-- Access Level Badge -->
                <div id="access-badge" class="badge badge-success" style="display: none; margin-right: 16px;">
                    ‚úì Full Access
                </div>
                
                <!-- Theme Toggle -->
                <div class="theme-switcher">
                    <span class="theme-icon">‚òÄÔ∏è</span>
                    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme"></button>
                    <span class="theme-icon">üåô</span>
                </div>
                
                <!-- Organization Switcher -->
                <div class="org-switcher">
                    <label for="org-select">Organization:</label>
                    <select id="org-select">
                        <option value="Triumph Atlantic">Triumph Atlantic</option>
                        <option value="Guercio Energy Group">Guercio Energy Group</option>
                        <option value="Myers Industrial Services">Myers Industrial Services</option>
                        <option value="KMP">KMP</option>
                        <option value="Stable Works">Stable Works</option>
                        <option value="Red Door">Red Door</option>
                        <option value="Fritz Staffing">Fritz Staffing</option>
                        <option value="Byers">Byers</option>
                    </select>
                </div>
                
                <!-- User Menu -->
                <div class="user-menu">
                    <button id="logout-btn" class="btn btn-ghost btn-sm">Logout</button>
                </div>
            </div>
        </header>

        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <div class="nav-menu">
                <div class="nav-section">
                    <button class="nav-item active" data-page="dashboard">
                        Dashboard
                    </button>
                    <button class="nav-item" data-page="intelligence">
                        Office of National Intelligence
                    </button>
                </div>
                
                <div class="nav-section">
                    <h3 class="nav-section-title">CRM</h3>
                    <button class="nav-item" data-page="companies">
                        Companies
                    </button>
                    <button class="nav-item" data-page="contacts">
                        Contacts & Gifts
                    </button>
                    <button class="nav-item" data-page="referrals">
                        Referrals
                    </button>
                </div>
                
                <div class="nav-section">
                    <h3 class="nav-section-title">Sales</h3>
                    <button class="nav-item" data-page="opportunities">
                        Opportunities
                    </button>
                    <button class="nav-item" data-page="projects">
                        Projects
                    </button>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="dashboard" class="page active">
                <div class="page-header">
                    <h2 class="page-title">Dashboard</h2>
                    <p class="page-subtitle">Overview of your key metrics and recent activity</p>
                </div>

                <div class="card-grid">
                    <div class="card kpi-card clickable" data-page="contacts">
                        <div class="kpi-value" id="kpi-overdue-touches">‚Äî</div>
                        <div class="kpi-label">Overdue Touches</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="kpi-last-gift">‚Äî</div>
                        <div class="kpi-label">Days Since Last Gift</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="kpi-referrals">‚Äî</div>
                        <div class="kpi-label">Referrals Asked (30d)</div>
                    </div>
                    <div class="card kpi-card">
                        <div class="kpi-value" id="kpi-open-opps">‚Äî</div>
                        <div class="kpi-label">Open Opps (Weighted)</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Recent Activity</h3>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Action</th>
                                    <th>Details</th>
                                </tr>
                            </thead>
                            <tbody id="dashboard-activity-body">
                                <tr>
                                    <td colspan="3" class="table-empty">Loading activity...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Intelligence Page -->
            <div id="intelligence" class="page">
                <div class="page-header">
                    <h2 class="page-title">Office of National Intelligence</h2>
                    <p class="page-subtitle">Comprehensive intelligence on companies, contacts, and business relationships</p>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Intelligence Summary</h3>
                    </div>
                    <div class="card-grid">
                        <div class="card kpi-card">
                            <div class="kpi-value" id="intel-companies">‚Äî</div>
                            <div class="kpi-label">Companies Tracked</div>
                        </div>
                        <div class="card kpi-card">
                            <div class="kpi-value" id="intel-locations">‚Äî</div>
                            <div class="kpi-label">Total Locations</div>
                        </div>
                        <div class="card kpi-card">
                            <div class="kpi-value" id="intel-contacts">‚Äî</div>
                            <div class="kpi-label">Total Contacts</div>
                        </div>
                        <div class="card kpi-card">
                            <div class="kpi-value" id="intel-unserved">‚Äî</div>
                            <div class="kpi-label">Unserved Locations</div>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Contractor Intelligence Matrix</h3>
                        <p class="card-subtitle">Who serves which companies across all service lines</p>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Company</th>
                                    <th>Electrical</th>
                                    <th>Mechanical</th>
                                    <th>Interior GC</th>
                                    <th>Marketing</th>
                                    <th>Staffing</th>
                                </tr>
                            </thead>
                            <tbody id="intel-matrix-body">
                                <tr>
                                    <td colspan="6" class="table-empty">Loading matrix...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Location Intelligence</h3>
                        <p class="card-subtitle">All company locations with contact coverage status</p>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Company</th>
                                    <th>Location</th>
                                    <th>City/State</th>
                                    <th>Contacts</th>
                                    <th>Last Contacted</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="intel-locations-body">
                                <tr>
                                    <td colspan="6" class="table-empty">Loading locations...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Companies Page -->
            <div id="companies" class="page">
                <div class="page-header">
                    <h2 class="page-title">Companies</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" id="add-company-btn">+ Add Company</button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <input type="text" class="search-input" placeholder="Search companies..." id="companies-search">
                        <div class="table-filters">
                            <select class="form-select" id="tier-filter">
                                <option value="">All Tiers</option>
                                <option value="Enterprise">Enterprise</option>
                                <option value="Large">Large</option>
                                <option value="Mid">Mid</option>
                            </select>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th class="sortable">Company Name</th>
                                    <th class="sortable">Tier</th>
                                    <th class="sortable">Status</th>
                                    <th>HQ State</th>
                                    <th>Locations</th>
                                    <th>Contacts</th>
                                </tr>
                            </thead>
                            <tbody id="companies-table-body">
                                <tr>
                                    <td colspan="6" class="table-empty">Loading companies...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Contacts Page -->
            <div id="contacts" class="page">
                <div class="page-header">
                    <h2 class="page-title">Contacts & Gifts</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" id="add-contact-btn">+ Add Contact</button>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <input type="text" class="search-input" placeholder="Search contacts..." id="contacts-search">
                        <div class="table-filters">
                            <button class="btn btn-sm" id="show-overdue-btn">Show Overdue Only</button>
                        </div>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th class="sortable">Name</th>
                                    <th>Title</th>
                                    <th class="sortable">Company</th>
                                    <th>Location</th>
                                    <th>Channel</th>
                                    <th class="sortable">Last Contacted</th>
                                    <th class="sortable">Next Touch Due</th>
                                    <th>Last Gift</th>
                                </tr>
                            </thead>
                            <tbody id="contacts-table-body">
                                <tr>
                                    <td colspan="8" class="table-empty">Loading contacts...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Referrals Page -->
            <div id="referrals" class="page">
                <div class="page-header">
                    <h2 class="page-title">Referrals</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" id="add-referral-btn">+ Add Referral</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Active Referrals</h3>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Referred Person</th>
                                    <th>Company</th>
                                    <th>Referred By</th>
                                    <th class="sortable">Follow-up Date</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="referrals-table-body">
                                <tr>
                                    <td colspan="5" class="table-empty">Loading referrals...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Opportunities Page -->
            <div id="opportunities" class="page">
                <div class="page-header">
                    <h2 class="page-title">Opportunities</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" id="add-opportunity-btn">+ Add Opportunity</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Active Opportunities</h3>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Company</th>
                                    <th>Location</th>
                                    <th>Job Description</th>
                                    <th>Contact</th>
                                    <th class="sortable">Start Date</th>
                                    <th class="sortable">Valuation</th>
                                </tr>
                            </thead>
                            <tbody id="opportunities-table-body">
                                <tr>
                                    <td colspan="6" class="table-empty">Loading opportunities...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Projects Page -->
            <div id="projects" class="page">
                <div class="page-header">
                    <h2 class="page-title">Projects</h2>
                    <div class="page-actions">
                        <button class="btn btn-primary" id="add-project-btn">+ Add Project</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Active Projects</h3>
                    </div>
                    <div class="table-wrapper">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Company</th>
                                    <th>Location</th>
                                    <th>Job Description</th>
                                    <th>Contact</th>
                                    <th class="sortable">Start Date</th>
                                    <th class="sortable">End Date</th>
                                    <th class="sortable">Valuation</th>
                                </tr>
                            </thead>
                            <tbody id="projects-table-body">
                                <tr>
                                    <td colspan="7" class="table-empty">Loading projects...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- JavaScript Files (in order) -->
    <!-- 1. Configuration -->
    <script src="assets/js/config.js"></script>
    
    <!-- 2. Utilities -->
    <script src="assets/js/utils.js"></script>
    
    <!-- 3. Mock Data -->
    <script src="assets/js/mock-data.js"></script>
    
    <!-- 4. Services -->
    <script src="services/auth-service.js"></script>
    <script src="services/api-service.js"></script>
    <script src="services/visibility-service.js"></script>
    <script src="services/data-service.js"></script>
    
    <!-- 5. Components (will be created next) -->
    <script src="components/shared/header.js"></script>
    <script src="components/shared/sidebar.js"></script>
    <script src="components/dashboard/dashboard.js"></script>
    <script src="components/intelligence/intelligence.js"></script>
    <script src="components/companies/companies.js"></script>
    <script src="components/contacts/contacts.js"></script>
    <script src="components/referrals/referrals.js"></script>
    <script src="components/opportunities/opportunities.js"></script>
    <script src="components/projects/projects.js"></script>
    
    <!-- 6. Main App -->
    <script src="assets/js/app.js"></script>
</body>
</html>
